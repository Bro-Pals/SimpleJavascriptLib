<!DOCTYPE html>
<head>
	<meta charset="UTF-8" />
	<title>Test Page</title>
	<script src="gamethings.js"></script>
	<script type="x-shader/x-vertex" id="vertexShader1">
		attribute vec2 loc;

		void main() {
			gl_Position = vec4(loc, 0.0, 1.0);
		}
	</script>
	<script type="x-shader/x-fragment" id="fragmentShader1">
		void main() {
			gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
		}
	</script>
</head>
<body onload="go()">
	<canvas id="can" width="400" height="300"></canvas>
	<script>
    var locAttrLocation;
    var vertexBuffer;
    var elementBuffer;
		function initState() {
			var vertexShader = loadShader("vertexShader1", gl.VERTEX_SHADER);
			var fragShader = loadShader("fragmentShader1", gl.FRAGMENT_SHADER);
			var program = makeProgram(vertexShader, fragShader);
			//Don't forget to delete shaders when you are done with them
			gl.deleteShader(vertexShader);
			gl.deleteShader(fragShader);
      // attributes locations
      locAttrLocation = gl.getAttribLocation(program, "loc");
      // dont need to save the uniform locations because there are none.
			gl.useProgram(program);

      // initilzize a buffer thing
      vertexBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
      var vertices = new Float32Array([
        -0.5, -0.5,
         0.5, -0.5,
         0.0,  0.5
      ]);
      gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);
      elementBuffer = gl.createBuffer();
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, elementBuffer);
      var elementData = new Uint8Array([ 0, 1, 2 ]);
      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, elementData, gl.STATIC_DRAW);

      // specify how the attributes are setup
      gl.vertexAttribPointer(
            locAttrLocation,
            2,
            gl.FLOAT,
            false,
            Float32Array.BYTE,
            0
            );
      gl.enableVertexAttribArray(locAttrLocation);
		}
		function update(_diff) {

		}
		function render(_diff) {
      gl.clearColor(0.9, 0.9, 0.9, 1.0);
      gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
      gl.drawElements(gl.TRIANGLES, 3, gl.UNSIGNED_BYTE, 0);
		}
		function keyInput(_pressed, _keycode) {

		}
		function go() {
			GameManager.setCanvas("can", "webgl");
			GameManager.createState(
				"state1",
				initState,
				update,
				render,
				{
					key : keyInput
				}
			);
			GameManager.setState("state1");
			GameManager.loop();
		}
	</script>
</body>
